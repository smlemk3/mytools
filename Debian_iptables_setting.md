# Debian iptables 配置 / 屏蔽 censys shodan 扫描

安装iptables自启动
```Bash
apt install -y iptables-persistent
```
iptables-persistent 的配置文件位置 /etc/iptables/rules.v4 /etc/iptables/rules.v6
IPv4 防火墙规则
```Bash
cat <<EOF > /etc/iptables/rules.v4
# Generated by iptables-save v1.8.9 (nf_tables) on Sat May 11 17:37:22 2024
*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
# block censys shodan
-A INPUT -s 208.180.20.97/32 -j DROP
-A INPUT -s 198.20.69.74/32 -j DROP
-A INPUT -s 198.20.69.98/32 -j DROP
-A INPUT -s 198.20.70.114/32 -j DROP
-A INPUT -s 198.20.99.130/32 -j DROP
-A INPUT -s 93.120.27.62/32 -j DROP
-A INPUT -s 66.240.236.119/32 -j DROP
-A INPUT -s 71.6.135.131/32 -j DROP
-A INPUT -s 66.240.192.138/32 -j DROP
-A INPUT -s 71.6.167.142/32 -j DROP
-A INPUT -s 82.221.105.6/32 -j DROP
-A INPUT -s 82.221.105.7/32 -j DROP
-A INPUT -s 71.6.165.200/32 -j DROP
-A INPUT -s 188.138.9.50/32 -j DROP
-A INPUT -s 85.25.103.50/32 -j DROP
-A INPUT -s 85.25.43.94/32 -j DROP
-A INPUT -s 71.6.146.185/32 -j DROP
-A INPUT -s 71.6.158.166/32 -j DROP
-A INPUT -s 198.20.87.98/32 -j DROP
-A INPUT -s 66.240.219.146/32 -j DROP
-A INPUT -s 209.126.110.38/32 -j DROP
-A INPUT -s 104.236.198.48/32 -j DROP
-A INPUT -s 104.131.0.69/32 -j DROP
-A INPUT -s 162.159.244.38/32 -j DROP
-A INPUT -s 93.174.95.106/32 -j DROP
-A INPUT -s 94.102.49.193/32 -j DROP
-A INPUT -s 80.82.77.139/32 -j DROP
-A INPUT -s 94.102.49.190/32 -j DROP
-A INPUT -s 185.163.109.66/32 -j DROP
-A INPUT -s 89.248.172.16/32 -j DROP
-A INPUT -s 71.6.146.186/32 -j DROP
-A INPUT -s 89.248.167.131/32 -j DROP
-A INPUT -s 159.203.176.62/32 -j DROP
-A INPUT -s 185.181.102.18/32 -j DROP
-A INPUT -s 80.82.77.33/32 -j DROP
-A INPUT -s 216.117.2.180/32 -j DROP
-A INPUT -s 71.6.199.23/32 -j DROP
-A INPUT -s 185.142.236.34/32 -j DROP
-A INPUT -s 185.165.190.34/32 -j DROP
-A INPUT -s 185.142.236.35/32 -j DROP
-A INPUT -s 66.240.219.133/32 -j DROP
-A INPUT -s 143.198.225.197/32 -j DROP
-A INPUT -s 137.184.95.216/32 -j DROP
-A INPUT -s 64.227.90.185/32 -j DROP
-A INPUT -s 143.198.238.87/32 -j DROP
-A INPUT -s 137.184.190.205/32 -j DROP
-A INPUT -s 137.184.112.192/32 -j DROP
-A INPUT -s 137.184.190.188/32 -j DROP
-A INPUT -s 167.172.219.157/32 -j DROP
-A INPUT -s 143.110.239.2/32 -j DROP
-A INPUT -s 143.198.68.20/32 -j DROP
-A INPUT -s 137.184.190.194/32 -j DROP
-A INPUT -s 137.184.190.246/32 -j DROP
-A INPUT -s 137.184.9.17/32 -j DROP
-A INPUT -s 137.184.13.100/32 -j DROP
-A INPUT -s 137.184.94.133/32 -j DROP
-A INPUT -s 137.184.112.103/32 -j DROP
-A INPUT -s 137.184.180.190/32 -j DROP
-A INPUT -s 143.198.50.234/32 -j DROP
-A INPUT -s 185.142.236.36/32 -j DROP
-A INPUT -s 185.142.236.40/32 -j DROP
-A INPUT -s 185.142.236.41/32 -j DROP
-A INPUT -s 185.142.236.43/32 -j DROP
-A INPUT -s 185.142.239.16/32 -j DROP
-A INPUT -s 198.20.69.96/29 -j DROP
-A INPUT -s 198.20.70.112/29 -j DROP
-A INPUT -s 198.20.87.96/29 -j DROP
-A INPUT -s 198.20.99.128/29 -j DROP
-A INPUT -s 66.240.205.34/32 -j DROP
-A INPUT -s 71.6.146.130/32 -j DROP
-A INPUT -s 71.6.147.198/32 -j DROP
-A INPUT -s 71.6.147.254/32 -j DROP
-A INPUT -s 71.6.150.153/32 -j DROP
-A INPUT -s 71.6.167.125/32 -j DROP
-A INPUT -s 89.248.172.7/32 -j DROP
-A INPUT -s 162.142.125.0/24 -j DROP
-A INPUT -s 167.94.138.0/24 -j DROP
-A INPUT -s 167.94.145.0/24 -j DROP
-A INPUT -s 167.94.146.0/24 -j DROP
-A INPUT -s 167.248.133.0/24 -j DROP
-A INPUT -s 199.45.154.0/24 -j DROP
-A INPUT -s 199.45.155.0/24 -j DROP
-A INPUT -s 206.168.34.0/24 -j DROP
# block end
-A INPUT -i lo -j ACCEPT
-A INPUT -d 127.0.0.0/8 ! -i lo -j REJECT --reject-with icmp-port-unreachable
-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
-A INPUT -p tcp -m tcp --dport 80 -j ACCEPT
-A INPUT -p tcp -m tcp --dport 443 -j ACCEPT
-A INPUT -p tcp -m tcp --dport 3306 -j DROP
-A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT
-A INPUT -p icmp -m icmp --icmp-type 8 -j ACCEPT
# BLOCK ALL OTHER INPUT
-A INPUT -j REJECT --reject-with icmp-port-unreachable
-A OUTPUT -j ACCEPT
COMMIT
# Completed on Sat May 11 17:37:22 2024
EOF
```
IPv6 防火墙规则
```Bash
cat <<EOF > /etc/iptables/rules.v6
# Generated by ip6tables-save v1.8.9 (nf_tables) on Sat May 11 17:44:56 2024
*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
-A INPUT -i lo -j ACCEPT
-A INPUT -p tcp -m tcp --dport 3306 -j DROP
-A INPUT -s 2602:80d:1000:b0cc:e::/80 -j DROP
-A INPUT -s 2620:96:e000:b0cc:e::/80 -j DROP
-A INPUT -s 2602:80d:1003::/112 -j DROP
-A INPUT -s 2602:80d:1004::/112 -j DROP
COMMIT
# Completed on Sat May 11 17:44:56 2024
EOF
```
```Bash
/etc/init.d/netfilter-persistent reload
```
